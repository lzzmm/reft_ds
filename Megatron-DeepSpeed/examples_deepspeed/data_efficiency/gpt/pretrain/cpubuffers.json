{'rng_state': [{'rng_tracker_states': {'model-parallel-rng': tensor([112,  15,   0,   0,   0,   0,   0,   0, 236, 105,   0,   0,   0,   0,
          0,   0], dtype=torch.uint8)}, 'cuda_rng_state': tensor([210,   4,   0,   0,   0,   0,   0,   0,  88,  46,   0,   0,   0,   0,
          0,   0], dtype=torch.uint8), 'torch_rng_state': tensor([210,   4,   0,  ...,   0,   0,   0], dtype=torch.uint8), 'np_rng_state': ('MT19937', array([      1234, 3159640283, 4062961311, 3954462607, 3112783424,
       2849714703,  731821095, 2232873578, 1251953424, 3917199038,
        231030171,  268845362, 2344188614, 1849447265, 2383103214,
       2227731755, 1714639421, 1491439037,  462325566,    5081481,
        737186849,  236395034, 2597008984, 1186503577,  323074832,
       2742705513, 2905742929, 4282737114,  279690169, 2839941402,
       3748828822, 1960715752, 1397597709,   97709789, 4061626963,
       1748187571,  838075742,  431451195,  669402733, 3800374824,
       2463558175, 2497634970, 1432010274,  864206586, 4221510350,
       3741544462, 1605184079, 2065133301,  323705460, 1498334197,
       2929517430,   30068983,  697933991, 2032582936, 1565495315,
       3975903569, 4234264466, 1259089262,  841438213, 1033753396,
       2075600832, 1439692898, 3048143437, 2116421738, 2121241975,
       2000428495, 4014801032, 1182308890, 4073340907, 2773901005,
       1601777393,  226358519, 2710230203, 3836472902, 3661295235,
        677550283, 2218257251, 1923991186, 2950234957, 4002190714,
       2076424717, 3105673997, 2394639421,  896257070, 3238931578,
         62082322,  494537328, 2043416199,  787575094, 2605813927,
       2115591795,   11224405, 2902448101, 2261503360, 3052447400,
       3620256625, 3332372058, 1080087166, 2354185085, 3971176574,
       2223492789, 3526720920, 1653571981, 1237715107, 2855148114,
       1215640057, 1271033666, 1075167450, 2529642963, 1406662882,
        983280893, 3857294656, 2272530143,  818487970,  760306780,
       3255479487, 1305133728, 1905128186, 1290154109,  707231075,
       4116935559, 3786028941, 2361715072,  624210629, 3772314933,
       1296868555, 1022565936,  979540335, 3540774987, 2571392233,
       2144617529, 2227757723, 2729723873, 1724766228, 2087484879,
       2126700749, 2193874180, 4223166951,  363383678, 2565912385,
       1876961531, 2956195119,   49270863, 2235594426, 4043263784,
         71647112, 3674855738, 2897294608,   47092398,  314637627,
       2118482909,  867605091,  475980967, 2925434236, 2814601552,
       1018392565, 1701333317, 2184596593,  159036669,  389008752,
       2564619728,  465798779,  679010857,  601369552, 3328940468,
       1169659096, 1577376579, 2282673073, 3943256391, 2684777597,
       1516039621, 2453910271, 2422866813, 1647007944,  656185595,
       3473125046, 3353725721, 1561332723, 3109501228, 3309645273,
        315277750, 4288861059, 3337417270, 1150086304, 3668084029,
        136233007, 3192126021, 1035124158, 1463913138, 3472524380,
       1816531257, 1331938263, 1493420590, 2163928140, 2308372872,
        518082101, 1093744813,  745760929,  351105355,  274454110,
        512090590, 2244209503, 1254859131, 1578565613, 4252779752,
       2304111748, 1718562732,  874276112, 1153003552, 1460790998,
       4068090533,   21267025, 3858482121,  178346375, 4047671833,
       3324612377, 1303404570,  247553664, 3814508890, 1758138872,
       2391496985, 2741410692,  694162108, 2417099019, 1290222189,
       1047648637, 1052357683, 2451072002, 1831040228, 3603868734,
       3412171255, 2660323883, 3748420629, 4020378519, 2093160014,
       2417038614, 4270917072,  941242412, 1134278218, 2701791110,
        132236292, 4195646085, 2169507280, 3568883405, 2676162106,
       2621588749, 1417889505,  148428631,  539723083, 1150139024,
        716780847, 1087447942, 1798784063, 3859094387, 2076361774,
       1075678858, 2797510871,  253391370, 1924946164, 3667736236,
       3037936399, 3565896230, 3428443807, 3659888787,  708682200,
        852849473, 3685434031, 3019070183, 1391094373, 1109884545,
       2982635918, 3455881547, 3344751224,  904595096, 1516827402,
        516278122,  665151462,  136713427,  770712405, 1979281056,
       4194553757,   49182831, 3851545573,  622471385, 1293762489,
       1907072181, 3900516386, 3099688740, 4083974430, 3736237714,
       3352518999,  247946055, 4151378727, 1614840409,  798787038,
       3715538877, 1635497246, 2979335524,  969138280, 2687971891,
       3405383553, 4013394295, 3416543218,  573736004, 3566375940,
       1329407732, 1772911835, 1641278773, 1861839544,  965942578,
       1443383280,   56319052, 3447985972, 2617940204, 3532109088,
       1735340810, 1518143379, 1767841751, 2708149932,   86315493,
       4151745945, 1666816259,  743010572, 3989636863,  193240752,
        453954741, 2371264943, 2272157576, 1416793274, 1537120784,
       1753015039, 1806794113, 3887072460,  279817720, 3899087910,
        572139752, 1921928408, 4281562094, 1607570131, 2432651309,
       3689728735, 3640641057, 1088380608,  622636156,   67267140,
       2007913005, 1358166198, 2170294414, 3523310744,  909571460,
        867074674, 1892055641,  774856216, 1152579801, 3484403354,
       4224728256, 3070317907, 1801847642, 1921517389, 1051102819,
       2191403383, 2865297810, 2177402682, 3607253635, 1402015212,
       4129903854, 2335987695, 2639759088, 3009265898,  378619129,
       2483583151,  950481588,  654661240, 1034507981, 3470652759,
       2334637979, 4117133781, 1165727975, 3303041592, 2432728514,
       3904724540, 1373562712, 1982785691,  254947393, 2556875813,
       1764463588, 2006575067, 3686933637,  550379618, 2069183023,
       1141150636, 1318115784, 1144094421, 1278377773,  539933158,
       3509940041, 1705608126,   26948328, 4107353878,  652419544,
       4053857224, 3313816488, 4032497417, 4092863109, 1601525362,
       1437837300, 3900072511,  283828035, 3170497031,  189016722,
       2930437940, 3052292073, 1726751827, 2430089207, 3203609159,
       4156343256, 2168879623,  708694682, 2051965540, 1904509052,
       4050950133, 2550963123, 2854365051, 2263373156, 3978774758,
        818237698, 3846244724, 3069865118, 4247803704,  157155060,
       3895602162, 1424380100,  293227625, 3137558558, 3409756350,
       3007852868, 1053026386, 2363264015, 3931191255, 3753344091,
       4216793200, 1831698968, 2286073495, 1343932292, 2147083829,
       1966450753, 2398462718, 2684758827, 3920034285, 3357735591,
       3093997686, 1634110343, 2798240674, 2695548901, 4025984745,
       2104366617,  552177984, 4087451657, 3172544444, 2343470529,
       1841636027,  963788591, 1546393177, 2982275719, 1839576393,
       1163661113, 2885614314,  204941147, 3444521915, 2839546221,
        559489441, 2995810140, 1915174894, 2654741028, 2466894040,
       4053406173, 3932871794, 1597535090, 1932728637, 3427668619,
       1148197256, 2091083246,  999104557, 3793799332, 3001125575,
        765603486, 3124819004,  336039005,   61024153, 1623097926,
       2731697901, 2057405750, 2860842911, 2895044574, 2033127354,
       1360611766, 3211658787, 2123830774, 2585647973, 1006809238,
        967439138, 2971148383, 3865152423,  431152555,  266271087,
       1014878660, 2671880270, 2718700535, 1294270117, 1650080945,
         14951278, 3506035301,  691913278, 3389182583, 3874037190,
       3343527356,  653804895,  917256064, 1076193158,  467278154,
       2644153914, 2749972001, 4097523929, 3473621517, 1814859666,
       2003784204, 1815041583, 3339558965, 4237761886, 2413845698,
       1583831506,  110976338, 4165252462, 2855136022, 2490856698,
       1401020399, 4204116222, 3355206378, 4158699783, 3452445871,
       3695871480, 1492594980, 1456878263,  245328365, 4128219553,
        890796299, 4273710713, 4051040837, 3328521666, 1408860234,
       3441738429,  384468253, 1804471193, 3831950625,   91275924,
       1068104335, 1125082007, 2994180699, 4075642955, 3794110103,
       1809796756,  305840122, 1505790420,  327966780, 3347453408,
       3604094916,  106498745, 2129477172,  425126433, 3581741630,
        679129419,  508958674, 1232390678, 3051031632, 3879846040,
        356577894, 3441572478, 2503539346, 4152487186, 3583484664,
       3286803019, 2576912557,  124239441, 3506336060, 1270245155,
       2786452659,  719123743, 4029894278, 2061904325, 2105827489,
       2169487726, 2364415467,  626163773,  500711266, 2481616380,
        915897737, 3601980001,  850894079,  611215857,  131647340,
        523467764,  810646941, 1470797387,  885057421, 3705721341,
       1527105939,  489007864, 4112723511, 3188134116, 1058980639,
       3345454237, 3535286969, 2431094726, 3047661241, 2586883373,
       2927011058,  363037976, 3479526625, 4091582868, 1357867518,
       2284276487, 3888728166, 3236601671, 3064478787], dtype=uint32), 624, 0, 0.0), 'random_rng_state': (3, (2147483648, 681931688, 3687344416, 1319623383, 1733778962, 4241987723, 4074262549, 2852002034, 1679630986, 2918199511, 1674139314, 4196750923, 968756412, 2753032487, 1705664285, 3459981360, 1142784505, 2171775483, 1370631056, 2775989752, 1785361050, 1628402989, 1254938217, 2157223279, 3435839812, 528362357, 3271176718, 1717150560, 2413674734, 3401445834, 2201263715, 2421669659, 2645483063, 1144866702, 3421830138, 4090598626, 447497167, 2572859688, 1850404299, 4219968223, 4035019772, 1353986065, 1694482055, 1791707964, 2349682119, 4257230194, 4109727256, 564774337, 3336065033, 1715151449, 2025128814, 4175226335, 1943810571, 465832794, 3104350400, 1653998836, 828982119, 2738537898, 3024997251, 218535967, 1883586163, 1798051650, 807368803, 760703514, 2837153657, 319530812, 3353629048, 2825980806, 3191854838, 2616319652, 3467188225, 2782366099, 1797715374, 1143408062, 3569792715, 251173462, 392222100, 4144952265, 684161103, 2900426747, 234189537, 571293968, 1969293749, 3268195902, 2628399631, 2433628604, 685592055, 2215111937, 3095492517, 3432690175, 425388214, 2935265105, 98575693, 3749251114, 1319630044, 1144656076, 1580177834, 2240151088, 1520459680, 2189516440, 2869373670, 3624938686, 3677551146, 1563906551, 3017409652, 1334993773, 559961705, 2136399688, 742682475, 887032216, 3739953044, 4072707551, 515676514, 3460171448, 3036662203, 1311422443, 3302280719, 363818740, 312907013, 2299317514, 1580584798, 3532139947, 3652092379, 1910510756, 3638468239, 1811908616, 2098942134, 3000613446, 3938495524, 3320846352, 880077778, 796896276, 1287970445, 756730311, 3077299094, 1682806788, 2410341940, 3394168093, 3808225777, 3390200906, 717125844, 2804035518, 2929326224, 1119912672, 1680648232, 729150302, 716343139, 447159972, 1798147991, 3295635192, 1755032061, 3764911000, 3917593451, 2074340743, 3845432393, 149764650, 3819429514, 3062893055, 3828664278, 165784947, 1626454788, 2281761805, 3925812272, 360610032, 1231083002, 1382443094, 1330284398, 2894777026, 250056091, 2364308044, 2599401194, 3490569332, 204162989, 907314392, 93755084, 2877959744, 604520541, 2542386574, 1462307092, 1657760498, 937139779, 195187747, 70805286, 777513415, 3900225203, 2563853818, 3394023625, 2759683673, 405771938, 3668716808, 4287435602, 460121472, 3573937221, 1157458837, 473549445, 3807483727, 1626727759, 3760043675, 2570920968, 4276760455, 1542678648, 1010118806, 2439506676, 3581291265, 3163568279, 2813816727, 820065814, 1500693415, 366035914, 20044033, 3322266701, 4058985355, 498839600, 1393198846, 3505922491, 28834564, 3999423145, 663062953, 1592297648, 1383172742, 1538043163, 1780576128, 2858243512, 1723114605, 1480935410, 3359333525, 2100249596, 1887911981, 2492266430, 2777938879, 1027101135, 185395784, 2398828499, 1543167549, 218017817, 1540265805, 1897058599, 4190296766, 238073549, 957973836, 79753109, 3280155219, 3769231695, 654496669, 977603257, 473220975, 3333252597, 415836576, 3281527217, 1783951381, 478715560, 2977458471, 1382527784, 4056412942, 485031387, 385876437, 1776484280, 1634518068, 555953991, 834548476, 2319392986, 3736364950, 3385108376, 1810215441, 1508125637, 2186756838, 808214620, 3764143815, 4045248765, 263682784, 3801499284, 1944790434, 1987605600, 2613275985, 3946805088, 3915478803, 3982906550, 2401492386, 3234790776, 1856986977, 3742079195, 2464001012, 2977067046, 4062124500, 3855224546, 2578504324, 3349932125, 3781389749, 2143738204, 2490195743, 1562552605, 3438739391, 1436502547, 1367868601, 2802913411, 1693105884, 3702003197, 1945116202, 4119680371, 3792769755, 511051877, 3195014189, 3149377492, 2958189639, 2846241936, 1147443455, 3888797460, 3835637185, 1516496264, 3671313856, 966785735, 3199144549, 221868710, 1768941353, 4060807456, 1098440981, 1780563064, 3305546257, 4145428225, 3623241359, 2400940861, 4146795389, 100791182, 4197949623, 31215319, 2203280981, 172061887, 3228050972, 2572190803, 3892129482, 2958606635, 1225600967, 1541327746, 1453837009, 4223410508, 4027184061, 3202739213, 3560959792, 3599537166, 2717926177, 3621189627, 3215566710, 2338835061, 1903830213, 2884771740, 4211996543, 2944737917, 39601148, 1286941087, 565743793, 3233373744, 1357539045, 3721194790, 1525108737, 1787712818, 3599258351, 2652203832, 3264169228, 856613472, 1821605404, 1935534245, 665712432, 812429601, 1817136759, 3360835947, 2398589238, 2623232316, 3920712702, 2285469089, 4006967101, 762412529, 1021010726, 2546190430, 1243592099, 864371057, 2136034367, 3669537428, 2317873314, 1318667780, 3836591536, 3506590208, 1174815687, 708800309, 1522453831, 98548912, 2959787572, 1772358852, 4031121781, 3173571360, 1512503866, 2783441999, 2859706818, 3678884024, 1596307245, 545483258, 2654017379, 771068207, 305882636, 95473695, 1620514454, 3456077457, 3382854867, 3356867705, 4059068714, 4092815339, 452975895, 1970780963, 3713109522, 753515873, 2054606228, 3726075273, 3558279506, 4227356358, 1092275327, 2588045886, 2110470422, 4177067338, 423244918, 2594038542, 1553409120, 2026699298, 750250137, 470320832, 1368390093, 3211670749, 4077145639, 1055342089, 626786913, 385295437, 3535399386, 2169031091, 1738878861, 3881437183, 2504026939, 3844903701, 2234558019, 1159840758, 1816438952, 1455174150, 810054099, 411945115, 2157260131, 2781743564, 889780141, 1215907980, 770996634, 102808355, 609659839, 87002159, 3234600513, 3004798770, 2060320199, 527259213, 3180501345, 768869304, 637036071, 254935222, 3377135593, 4153062205, 2817228360, 4046912253, 1139736047, 1402862327, 3568596544, 3315465267, 604938799, 1676542314, 120077193, 3812355714, 3543347463, 2284464100, 3017281249, 2654915152, 1407546083, 3888838437, 985935983, 1590263280, 1686452164, 804103748, 1041263338, 487283949, 1784118829, 1350411352, 769519034, 3495500694, 3512495346, 3919416951, 233818674, 3248610226, 3204945917, 2346290029, 3851460553, 2991108806, 3135978097, 1748214659, 3200823513, 4060238290, 434975704, 1184261973, 986235829, 598664306, 628387572, 3671557901, 3377134052, 969545704, 144209212, 3637362076, 3836617673, 2619366091, 2049131976, 3649237039, 946679209, 607059894, 917298143, 492805191, 806553406, 3745982929, 2974517190, 2870339284, 1749477599, 3259043051, 1598957548, 3980771077, 1299723022, 1414814262, 3846779376, 3945849854, 2184573408, 3843252526, 4050589313, 3315494868, 2089548284, 2512762996, 2488392494, 3319213937, 950574328, 3785806751, 1559855572, 2896039428, 3324860302, 945055643, 572693112, 1537029424, 201883074, 2083480691, 2274436471, 2367177063, 2054160989, 2803706650, 3440619503, 3307099996, 4097162409, 317929764, 2976405738, 3723203166, 4140291053, 919708075, 1623917373, 896073198, 404769443, 3386021059, 624530936, 2652173859, 209156446, 3570818229, 2984513634, 3294151552, 3824847141, 2336905631, 4152615042, 3816443772, 133781556, 3329843166, 3955269860, 1591266694, 2395390415, 3548204652, 690175473, 6930362, 368966209, 4230664070, 3427587150, 660972162, 3937596417, 2423938277, 3713211912, 1022511102, 3398757968, 3145271675, 1086834804, 1850861642, 158874682, 2425424777, 1754415174, 2021375521, 1732107495, 3572418165, 2327194611, 3634993387, 3703664025, 3636053413, 4168782546, 294885604, 2638180, 3676411395, 2887058866, 3313013321, 4109462471, 2962450030, 320620579, 3206297241, 1645574178, 1812184115, 3464030756, 1063347294, 4008468610, 605969333, 3509562641, 597703473, 3598551739, 794800473, 1318757528, 2487267773, 343805460, 624), None)}], 'universal_checkpoint_info': {'parameter_with_2_sub_params_cat_dim_0': [], 'parameter_with_row_parallelism_patterns': ['\\d+.mlp.dense_4h_to_h.weight', '\\d+.self_attention.dense.weight'], 'tp_replicated_parameter_patterns': ['\\d+.input_layernorm.weight', '\\d+.post_attention_layernorm.weight', '\\d+.weight', '\\d+.bias', 'tied_modules.embed.position_embeddings.weight', '\\d+.self_attention.dense.bias', '\\d+.mlp.dense_4h_to_h.bias', '\\d+.input_layernorm.bias', '\\d+.post_attention_layernorm.bias'], 'pipeline_replicated_parameter_patterns': ['tied_modules.embed.word_embeddings.weight', 'tied_modules.embed.position_embeddings.weight'], 'vocabulary_parameter_patterns': ['tied_modules.embed.word_embeddings.weight'], 'padded_vocab_size': 50688, 'original_vocab_size': 50257, 'universal_checkpoint_version': 0.2}, 'tokens': 8192, 'iteration': 1, 'checkpoint_version': 3.0, 'args': Namespace(num_layers=32, encoder_num_layers=32, decoder_num_layers=None, num_experts=[1], mlp_type='standard', topk=1, expert_interval=2, hidden_size=4096, ffn_hidden_size=16384, num_attention_heads=32, num_key_value_heads=32, kv_channels=128, max_position_embeddings=2048, use_rotary_position_embeddings=False, rope_theta=10000, rotary_percent=1.0, add_position_embedding=True, make_vocab_size_divisible_by=128, normalization='layernorm', layernorm_epsilon=1e-05, apply_layernorm_1p=False, mem_efficient_ln=True, apply_residual_connection_post_layernorm=False, openai_gelu=False, squared_relu=False, swiglu=False, onnx_safe=None, bert_binary_head=True, num_experts_switch=None, untie_embeddings_and_output_weights=False, embedding_weights_in_fp32=False, attention_dropout=0.1, hidden_dropout=0.1, weight_decay=0.1, start_weight_decay=0.1, end_weight_decay=0.1, weight_decay_incr_style='constant', clip_grad=1.0, adam_beta1=0.9, adam_beta2=0.95, adam_eps=1e-08, sgd_momentum=0.9, micro_batch_size=4, global_batch_size=4, rampup_batch_size=None, recompute_granularity=None, distribute_saved_activations=False, recompute_method=None, recompute_num_layers=1, checkpoint_activations=False, distribute_checkpointed_activations=False, checkpoint_num_layers=1, train_iters=30, train_samples=None, train_tokens=150000000000, random_ltd=False, log_interval=10, exit_interval=None, exit_duration_in_mins=30000000, exit_signal_handler=False, tensorboard_dir=None, masked_softmax_fusion=True, bias_gelu_fusion=True, bias_dropout_fusion=True, moe_token_dropping=True, moe_train_capacity_factor=1.0, moe_eval_capacity_factor=1.0, moe_min_capacity=4, moe_loss_coeff=0.1, create_moe_param_group=False, moe_top2_2nd_expert_sampling=True, use_flash_attn_v1=False, use_flash_attn_v2=False, use_flash_attn_triton=False, add_bias_linear=True, optimizer='adam', dataloader_type='single', ds_inference=False, cpu_optimizer=False, cpu_torch_adam=False, ds_fused_adam=False, no_pipeline_parallel=False, use_tutel=False, inference=False, async_tensor_model_parallel_allreduce=False, no_persist_layer_norm=False, sequence_parallel=False, ds_sequence_parallel_size=1, force_ds_sequence_parallel=False, gradient_accumulation_fusion=True, use_dataset_only=False, seed=1234, data_parallel_random_init=False, init_method_std=0.009, init_method_xavier_uniform=False, lr=0.00012, lr_decay_style='cosine', lr_decay_iters=30, lr_decay_samples=None, lr_decay_tokens=150000000000, lr_warmup_fraction=None, lr_warmup_iters=0, lr_warmup_samples=0, lr_warmup_tokens=3000000000, min_lr=1e-06, override_opt_param_scheduler=True, use_checkpoint_opt_param_scheduler=False, save='/dev/shm/reft/save/0329-225908', save_interval=1, no_save_optim=None, no_save_rng=None, load=None, load_tag=None, no_load_optim=None, no_load_rng=None, no_load_lr_state=False, finetune=False, perform_initialization=True, use_checkpoint_args=False, exit_on_missing_checkpoint=False, universal_checkpoint=False, checkpoint_new_thread=True, checkpoint_new_stream=True, double_checkpoint=False, enable_parity=False, enable_pin_memory=True, enable_sharding=True, save_embeddings=False, enable_profile=True, enable_save=False, fp16=True, bf16=False, loss_scale=None, initial_loss_scale=4294967296, min_loss_scale=1.0, loss_scale_window=1000, hysteresis=2, fp32_residual_connection=False, apply_query_key_layer_scaling=True, attention_softmax_in_fp32=False, accumulate_allreduce_grads_in_fp32=False, fp16_lm_cross_entropy=False, tensor_model_parallel_size=4, enable_expert_tensor_parallelism=False, pipeline_model_parallel_size=1, pipeline_model_parallel_split_rank=None, moe_expert_parallel_size=1, num_layers_per_virtual_pipeline_stage=None, overlap_p2p_comm=False, distributed_backend='nccl', distributed_timeout_minutes=10, DDP_impl='local', use_contiguous_buffers_in_local_ddp=True, scatter_gather_tensors_in_pipeline=True, use_ring_exchange_p2p=False, local_rank=0, lazy_mpu_init=None, use_cpu_initialization=None, empty_unused_memory_level=0, standalone_embedding_stage=False, use_distributed_optimizer=False, eval_iters=0, eval_interval=100, skip_train=False, aml_data_download_path=None, data_path=['/hpc2hdd/home/zli755/xueze/reft_ds/Megatron-DeepSpeed/examples_deepspeed/data_efficiency/gpt/pretrain/../../../../../md_preprocess/wikioutput_text_document'], split='949,50,1', train_data_path=None, valid_data_path=None, test_data_path=None, data_cache_path=None, vocab_size=None, vocab_file='gpt2-vocab.json', merge_file='gpt2-merges.txt', vocab_extra_ids=0, seq_length=2048, encoder_seq_length=2048, decoder_seq_length=None, retriever_seq_length=256, sample_rate=1.0, mask_prob=0.15, short_seq_prob=0.1, mmap_warmup=False, num_workers=0, tokenizer_type='GPT2BPETokenizer', tokenizer_model=None, data_impl='mmap', reset_position_ids=False, reset_attention_mask=False, eod_mask_loss=False, train_data_exact_num_epochs=None, return_data_index=False, data_efficiency_curriculum_learning=False, train_idx_path=None, train_desc_path=None, train_doc_idx_path=None, train_sample_idx_path=None, train_shuffle_idx_path=None, repeated_dataloader=False, adlr_autoresume=False, adlr_autoresume_interval=1000, ict_head_size=None, biencoder_projection_dim=0, biencoder_shared_query_context_model=False, ict_load=None, bert_load=None, titles_data_path=None, query_in_block_prob=0.1, use_one_sent_docs=False, evidence_data_path=None, retriever_report_topk_accuracies=[], retriever_score_scaling=False, block_data_path=None, embedding_path=None, indexer_batch_size=128, indexer_log_interval=1000, num_classes=1000, img_h=224, img_w=224, num_channels=3, patch_dim=16, classes_fraction=1.0, data_per_class_fraction=1.0, data_sharding=True, head_lr_mult=1.0, vision_pretraining=False, vision_pretraining_type='classify', vision_backbone_type='vit', swin_backbone_type='tiny', mask_type='random', mask_factor=1.0, iter_per_epoch=1250, dino_local_img_size=96, dino_local_crops_number=10, dino_head_hidden_size=2048, dino_bottleneck_size=256, dino_freeze_last_layer=1, dino_norm_last_layer=False, dino_warmup_teacher_temp=0.04, dino_teacher_temp=0.07, dino_warmup_teacher_temp_epochs=30, log_params_norm=False, log_num_zeros_in_grad=False, timing_log_level=0, barrier_with_L1_time=True, timing_log_option='minmax', tensorboard_log_interval=1, tensorboard_queue_size=1, log_timers_to_tensorboard=True, log_batch_size_to_tensorboard=True, log_learning_rate_to_tensorboard=True, log_loss_scale_to_tensorboard=True, log_validation_ppl_to_tensorboard=True, log_optimizer_states_to_tensorboard=True, log_memory_to_tensorboard=False, log_world_size_to_tensorboard=False, zero_stage=0, zero_reduce_scatter=False, zero_contigious_gradients=False, zero_reduce_bucket_size=0.0, zero_allgather_bucket_size=0.0, remote_device='none', use_pin_memory=False, scattered_embeddings=False, split_transformers=False, memory_centric_tiled_linear=False, tile_factor=1, deepspeed_activation_checkpointing=False, partition_activations=False, contigious_checkpointing=False, checkpoint_in_cpu=False, synchronize_each_layer=False, profile_backward=False, num_layers_teacher=None, num_experts_teacher=[1], hidden_size_teacher=None, num_attention_heads_teacher=None, mos=False, kd=False, kd_alpha_ce=1, kd_beta_ce=1, kd_temp=1.0, reset_iteration=False, load_teacher=None, inference_batch_times_seqlen_threshold=512, max_tokens_to_oom=12000, output_bert_embeddings=False, bert_embedder_type='megatron', fp8_e4m3=False, fp8_hybrid=False, fp8_wgrad=True, fp8_margin=0, fp8_interval=1, transformer_impl='local', fp8_amax_history_len=1, fp8_amax_compute_algo='most_recent', retro_workdir=None, retro_add_retriever=False, retro_cyclic_train_iters=None, retro_encoder_layers=2, retro_encoder_hidden_dropout=0.1, retro_encoder_attention_dropout=0.1, retro_num_neighbors=2, retro_num_retrieved_chunks=2, retro_return_doc_ids=False, deepspeed=True, deepspeed_config=None, deepscale=False, deepscale_config=None, deepspeed_mpi=False, ds_pipeline_enabled=True, rank=0, world_size=4, transformer_pipeline_model_parallel_size=1, data_parallel_size=1, virtual_pipeline_model_parallel_size=None, params_dtype=torch.float16, consumed_train_samples=12, consumed_valid_samples=0, consumed_train_tokens=24576, variable_seq_lengths=False, curriculum_learning_legacy=False, compression_training=False, use_flash_attn=False, padded_vocab_size=50688, deepspeed_config_dict={'train_batch_size': 4, 'train_micro_batch_size_per_gpu': 4, 'steps_per_print': 10, 'zero_optimization': {'stage': 0}, 'gradient_clipping': 1.0, 'prescale_gradients': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 500, 'hysteresis': 2, 'min_loss_scale': 1, 'initial_scale_power': 11}, 'wall_clock_breakdown': False, 'dataloader_drop_last': True, 'data_efficiency': {'enabled': True, 'seed': 1234, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'total_layer_num': 24, 'random_ltd_layer_num': 22, 'random_ltd_layer_id': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'model_mask_name': 'attention_mask', 'model_type': 'decoder', 'hidden_state_order': 'seq_batch_dim', 'random_ltd_schedule': {'min_value': 2048, 'max_value': 2048, 'schedule_type': 'fixed_linear', 'schedule_config': {'require_steps': 1, 'seq_per_step': 16}}}}, 'data_sampling': {'enabled': False, 'num_workers': 0, 'curriculum_learning': {'enabled': False, 'data_cluster_path': '', 'curriculum_metrics': {'dummy': {'index_to_sample_path': 'dummy', 'index_to_metric_path': 'dummy', 'difficulty_type': 'value', 'clustering_type': 'single_cluster', 'min_difficulty': 2048, 'max_difficulty': 2048, 'schedule_type': 'fixed_root', 'schedule_config': {'total_curriculum_step': 1, 'difficulty_step': 1, 'root_degree': 1}}}}}}}, model_type=<ModelType.encoder_or_decoder: 1>, attn_mask=tensor([[[[False,  True,  True,  ...,  True,  True,  True],
          [False, False,  True,  ...,  True,  True,  True],
          [False, False, False,  ...,  True,  True,  True],
          ...,
          [False, False, False,  ..., False,  True,  True],
          [False, False, False,  ..., False, False,  True],
          [False, False, False,  ..., False, False, False]]]], device='cuda:0'), allow_transformer_engine=False, iteration=3, do_train=1, do_valid=0, do_test=0, teacher_model=None, curr_iteration=3, actual_seq_length=2048), 'ds_version': '0.12.4+7122362f', 'ds_config': {'data_efficiency': {'data_sampling': {'curriculum_learning': {'curriculum_metrics': {'dummy': {'schedule_config': {'root_degree': 1, 'difficulty_step': 1, 'total_curriculum_step': 1}, 'schedule_type': 'fixed_root', 'max_difficulty': 2048, 'min_difficulty': 2048, 'clustering_type': 'single_cluster', 'difficulty_type': 'value', 'index_to_metric_path': 'dummy', 'index_to_sample_path': 'dummy'}}, 'data_cluster_path': '', 'enabled': False}, 'num_workers': 0, 'enabled': False}, 'data_routing': {'random_ltd': {'random_ltd_schedule': {'schedule_config': {'seq_per_step': 16, 'require_steps': 1}, 'schedule_type': 'fixed_linear', 'max_value': 2048, 'min_value': 2048}, 'hidden_state_order': 'seq_batch_dim', 'model_type': 'decoder', 'model_mask_name': 'attention_mask', 'random_ltd_layer_id': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'random_ltd_layer_num': 22, 'total_layer_num': 24, 'enabled': False}, 'enabled': False}, 'seed': 1234, 'enabled': True}, 'dataloader_drop_last': True, 'wall_clock_breakdown': False, 'fp16': {'initial_scale_power': 11, 'min_loss_scale': 1, 'hysteresis': 2, 'loss_scale_window': 500, 'loss_scale': 0, 'enabled': True}, 'prescale_gradients': True, 'gradient_clipping': 1.0, 'zero_optimization': {'stage': 0}, 'steps_per_print': 10, 'train_micro_batch_size_per_gpu': 4, 'train_batch_size': 4}, 'mp_world_size': 4, 'dp_world_size': 1, 'global_samples': 4, 'global_steps': 1, 'skipped_steps': 0, 'sparse_tensor_module_names': set(), 'random_ltd': None, 'data_sampler': None, 'lr_scheduler': {'wd_incr_steps': 120, 'wd_incr_style': 'constant', 'end_wd': 0.1, 'start_wd': 0.1, 'min_lr': 1e-06, 'lr_decay_tokens': 150000000000, 'lr_decay_steps': 120, 'lr_decay_style': 'cosine', 'num_tokens': 0, 'num_steps': 4, 'lr_warmup_tokens': 3000000000, 'lr_warmup_steps': 0, 'max_lr': 0.00012}, 'frozen_param_fragments': None, 'shared_params': None, 'frozen_param_shapes': None, 'param_shapes': None, 'optimizer': {'clip_grad': 1.0, 'fp32_groups_flat': [None, None], 'optimizer_state_dict': {'param_groups': [{'params': [0], 'step': 2, 'weight_decay': 0.1, 'eps': 1e-08, 'betas': (0.9, 0.95), 'bias_correction': True, 'lr': 0.0, 'lr_mult': 1.0, 'wd_mult': 1.0, 'name': 'wd_no_scale_lr'}, {'params': [1], 'step': 2, 'weight_decay': 0.0, 'eps': 1e-08, 'betas': (0.9, 0.95), 'bias_correction': True, 'lr': 0.0, 'lr_mult': 1.0, 'wd_mult': 0.0, 'name': 'no_wd_no_scale_lr'}], 'state': {1: {}, 0: {}}}, 'scale_window': 500, 'scale_factor': 2, 'last_overflow_iter': -1, 'cur_iter': 1, 'cur_scale': 2048, 'dynamic_loss_scale': True}, 'buffer_names': [], 'module': {}}